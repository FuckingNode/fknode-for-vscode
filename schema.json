{
    "$schema": "https://json-schema.org/draft-07/schema",
    "title": "FuckingNode configuration (fknode.yaml)",
    "type": "object",
    "description": "FuckingNode's project config file.",
    "properties": {
        "divineProtection": {
            "description": "Divine protection, basically to prevent certain cleanup features to affect this project. Array, or '*'.",
            "oneOf": [
                { "enum": ["*"] },
                {
                    "type": "array",
                    "items": {
                        "enum": ["updater", "cleaner", "linter", "prettifier", "destroyer"]
                    }
                }
            ]
        },
        "cleanerShortCircuit": {
            "type": "boolean",
            "description": "Set to true to short-circuit the clean command whenever a cleanup task fails.",
            "default": false
        },
        "lintScript": {
            "type": "string",
            "description": "Project script used for linting (defaults to ESLint if unset). String."
        },
        "prettyScript": {
            "type": "string",
            "description": "Project script used for prettifying (defaults to Prettier if unset). String."
        },
        "destroy": {
            "type": "object",
            "description": "Settings for the destroyer mechanism. Object.",
            "properties": {
                "intensities": {
                    "oneOf": [
                        { "enum": ["*"] },
                        {
                            "type": "array",
                            "items": {
                                "enum": ["normal", "hard", "hard-only", "maxim", "maxim-only"]
                            }
                        }
                    ],
                    "description": "Intensities the destroyer should run at."
                },
                "targets": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "File paths to be destroyed."
                }
            }
        },
        "commitActions": {
            "type": "boolean",
            "description": "If true, changes we make via cleanup (e.g. by prettifying the code) will be committed to Git if there wasn't any uncommitted change in here before. Boolean.",
            "default": true
        },
        "commitMessage": {
            "type": "string",
            "description": "Custom commit message for automated commits. String."
        },
        "updaterOverride": {
            "type": "string",
            "description": "Override the update command with a custom script. String."
        },
        "flagless": {
            "type": "object",
            "description": "Flagless features settings. Object.",
            "properties": {
                "flaglessUpdate": { "type": "boolean", "default": true },
                "flaglessDestroy": { "type": "boolean", "default": true },
                "flaglessLint": { "type": "boolean", "default": true },
                "flaglessPretty": { "type": "boolean", "default": true },
                "flaglessCommit": { "type": "boolean", "default": false }
            }
        },
        "releaseCmd": {
            "title": "releaseCmd",
            "description": "CmdSet for the release command.",
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "type": "string",
                        "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                        "pattern": "^(~|\\$|=|<).+"
                    },
                    {
                        "type": "object",
                        "description": "Cross-platform Cmd with MSFT Windows and POSIX macOS/Linux variants.",
                        "properties": {
                            "msft": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            },
                            "posix": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            }
                        },
                        "additionalProperties": false,
                        "minProperties": 1
                    }
                ]
            },
            "minItems": 1
        },
        "releaseAlwaysDry": {
            "type": "boolean",
            "description": "If true, releases always use dry-run, defaults to false. Boolean.",
            "default": true
        },
        "commitCmd": {
            "title": "commitCmd",
            "description": "CmdSet for the commit command.",
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "type": "string",
                        "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                        "pattern": "^(~|\\$|=|<).+"
                    },
                    {
                        "type": "object",
                        "description": "Cross-platform Cmd with MSFT Windows and POSIX macOS/Linux variants.",
                        "properties": {
                            "msft": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            },
                            "posix": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            }
                        },
                        "additionalProperties": false,
                        "minProperties": 1
                    }
                ]
            },
            "minItems": 1
        },
        "launchCmd": {
            "title": "launchCmd",
            "description": "CmdSet for the launch command.",
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "type": "string",
                        "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                        "pattern": "^(~|\\$|=|<).+"
                    },
                    {
                        "type": "object",
                        "description": "Cross-platform Cmd with MSFT Windows and POSIX macOS/Linux variants.",
                        "properties": {
                            "msft": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            },
                            "posix": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            }
                        },
                        "additionalProperties": false,
                        "minProperties": 1
                    }
                ]
            },
            "minItems": 1
        },
        "projectEnvOverride": {
            "enum": ["npm", "pnpm", "yarn", "deno", "bun", "go", "cargo"],
            "description": "Override project environment inference. If FuckingNode assumes this is a Node/pnpm project, but you set this to a different value, whatever you put here will take precedence."
        },
        "buildCmd": {
            "title": "buildCmd",
            "description": "CmdSet for the build command.",
            "type": "array",
            "items": {
                "oneOf": [
                    {
                        "type": "string",
                        "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                        "pattern": "^(~|\\$|=|<).+"
                    },
                    {
                        "type": "object",
                        "description": "Cross-platform Cmd with MSFT Windows and POSIX macOS/Linux variants.",
                        "properties": {
                            "msft": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            },
                            "posix": {
                                "type": "string",
                                "description": "Cmd. Must be prefixed with either ~, $, = or <, depending on the Cmd type.",
                                "pattern": "^(~|\\$|=|<).+"
                            }
                        },
                        "additionalProperties": false,
                        "minProperties": 1
                    }
                ]
            },
            "minItems": 1
        },
        "buildForRelease": {
            "type": "boolean",
            "description": "If true, when running fkrelease, run buildCmd before. Boolean.",
            "default": true
        }
    }
}
